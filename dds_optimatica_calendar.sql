CREATE LOCAL TEMPORARY TABLE calendar_new_data (
	     "month"      DATE
);

INSERT INTO calendar_new_data ("month")
SELECT * FROM sttgaz.dds_optimatica_calendar
UNION
SELECT TIMESTAMPADD(MONTH, number, '{{execution_date.year - 1}}-01-01')::date AS "month"
FROM 
	(
	SELECT 0 AS number
	UNION ALL
	SELECT 1 
	UNION ALL
	SELECT 2
	UNION ALL
	SELECT 3
	UNION ALL
	SELECT 4
	UNION ALL
	SELECT 5
	UNION ALL
	SELECT 6
	UNION ALL
	SELECT 7
	UNION ALL
	SELECT 8
	UNION ALL
	SELECT 9
	UNION ALL
	SELECT 10
	UNION ALL
	SELECT 11
	UNION ALL
	SELECT 12
	UNION ALL
	SELECT 13
	UNION ALL
	SELECT 14
	UNION ALL
	SELECT 15
	UNION ALL
	SELECT 16
	UNION ALL
	SELECT 17
	UNION ALL
	SELECT 18
	UNION ALL
	SELECT 19
	UNION ALL
	SELECT 20
	UNION ALL
	SELECT 21
	UNION ALL
	SELECT 22
	UNION ALL
	SELECT 23
	UNION ALL
	SELECT 24
	UNION ALL
	SELECT 25
	UNION ALL
	SELECT 26
	UNION ALL
	SELECT 27
	UNION ALL
	SELECT 28
	UNION ALL
	SELECT 29
	UNION ALL
	SELECT 30
	UNION ALL
	SELECT 31
	UNION ALL
	SELECT 32
	UNION ALL
	SELECT 33
	UNION ALL
	SELECT 34
	UNION ALL
	SELECT 35
	) AS val(number)
ORDER  BY "month";

DELETE FROM sttgaz.dds_optimatica_calendar;

INSERT INTO sttgaz.dds_optimatica_calendar
SELECT * FROM calendar_new_data;

COMMIT;
